<link rel="stylesheet" href="css/nascore_side.css"> <!--不要改动 这个文件 -->
<script src="js/side.js"></script> <!--不要改动 这个文件 -->
<div class="sidebar bg-dark text-light">
  <!-- 折叠按钮 -->
  <div class="sidebar-toggle" id="sidebarToggle">
    <i class="bi bi-chevron-left"></i>
  </div>

  <div class="sidebar-inner">
    <!-- 文件操作主菜单 -->
    <ul class="nav flex-column sidebar-menu">
      <li class="nav-item" data-action="">
        <a href="#system_server" class="nav-link active">
          <i class="bi bi-hdd-network me-2"></i>
          <span>服务器设置</span>
        </a>
      </li>

      <li class="nav-item" data-action="">
        <a href="#system_jwt" class="nav-link">
          <i class="bi bi-key-fill me-2"></i>
          <span>Jwt设置</span>
        </a>
      </li>


      <li class="nav-item" data-action="">
        <a href="#system_secret" class="nav-link">
          <i class="bi bi-key me-2"></i>
          <span>secret设置</span>
        </a>
      </li>
      <li class="nav-item" data-action="">
        <a href="#system_limit" class="nav-link">
          <i class="bi bi-truck me-2"></i>
          <span>limit设置</span>
        </a>
      </li>



      <li class="nav-item" data-action="my-files">
        <a href="#hashUserManager" class="nav-link ">
          <i class="bi bi-people me-2"></i>
          <span>用户管理</span>
        </a>
      </li>

      <hr />
      <!--
<div style="margin-left: 1rem;">扩展</div>
<hr />

-->
      <!-- 修改：NasCore扩展 折叠面板的标题和内容 -->
      <li class="nav-item">
        <a class="nav-link d-flex justify-content-between align-items-center" data-bs-toggle="collapse"
          href="#nascoreExtCollapse" role="button" aria-expanded="false" aria-controls="nascoreExtCollapse">
          <div>
            <i class="bi bi-gift me-2"></i>
            <span>NasCore扩展</span>
          </div>
          <i class="bi bi-chevron-down collapse-icon"></i>
        </a>
        <!-- NasCore扩展的折叠内容 -->
        <div class="collapse" id="nascoreExtCollapse">
          <ul class="nav flex-column ms-3">
            <li class="nav-item" data-action="my-files">
              <a href="#nascoreExt" class="nav-link">
                <i class="bi bi-card-text me-2"></i>
                <span>基础配置</span>
              </a>
            </li>
            <li class="nav-item"  data-action="my-files">
              <a href="#nascoreExt_vod" class="nav-link">
                <i class="bi bi-card-text me-2"></i>
                <span>NasCore_vod</span>
              </a>
            </li>
            <li class="nav-item" data-action="my-files">
              <a href="#nascoreExtSub3" class="nav-link">
                <i class="bi bi-card-text me-2"></i>
                <span>NasCore子项3</span>
              </a>
            </li>
          </ul>
        </div>
      </li>
      <script>
        // 每3秒查询一次extension_status，动态控制NasCore扩展子菜单显示
        function checkExtensionStatus() {
          fetch('/@api/extension_status')
            .then(res => res.json())
            .then(statusMap => {
              // 处理 nascore_vod
              var el1 = document.getElementById('nascore_vod');
              if (el1) el1.style.display = (statusMap.nascore_vod === false) ? 'none' : '';
              // 处理 nascore_vod2
              var el2 = document.getElementById('nascore_vod2');
              if (el2) el2.style.display = (statusMap.nascore_vod2 === false) ? 'none' : '';
            });
        }
        document.addEventListener('DOMContentLoaded', function () {
          checkExtensionStatus();
          setInterval(checkExtensionStatus, 3000);
        });
      </script>
      <!-- 第三方扩展折叠面板的标题 -->
      <li class="nav-item">
        <a class="nav-link d-flex justify-content-between align-items-center" data-bs-toggle="collapse"
          href="#thirdPartyExtCollapse" role="button" aria-expanded="false" aria-controls="thirdPartyExtCollapse">
          <div>
            <i class="bi bi-box-seam me-2"></i>
            <span>第三方扩展</span>
          </div>
          <i class="bi bi-chevron-down collapse-icon"></i>
        </a>
        <!-- 第三方扩展的折叠内容 -->
        <div class="collapse" id="thirdPartyExtCollapse">
          <ul class="nav flex-column ms-3"> <!-- ms-3 用于向右缩进子菜单 -->
            <li class=" nav-item" data-action="my-files">
              <a href="#ThirdPartyExtRclone" class="nav-link ">
                <i class="bi bi-inboxes me-2"></i>
                <span>Rclone挂载云储存</span>
              </a>
            </li>
            <li class="nav-item" data-action="my-files">
              <div class="nav-link d-flex justify-content-between align-items-center">
                <div>
                  <a href="#ThirdPartyExtDdnsGO" class="text-light text-decoration-none"><i
                      class="bi bi-inboxes me-2"></i>
                    <span>DDNS-GO动态解析</span></a>
                </div>
                <a href="{{.PrefixDdnsGo}}" target="_blank" class="text-light"><i class="bi bi-link-45deg me-2"></i></a>
              </div>
            </li>

            <li class="nav-item" data-action="my-files">
              <div class="nav-link d-flex justify-content-between align-items-center">
                <div>
                  <a href="#ThirdPartyExtadguardhome" class="text-light text-decoration-none"><i
                      class="bi bi-inboxes me-2"></i>
                    <span>adguard DNS分流</span></a>
                </div>
                <a href="{{.PrefixAdguardhome}}" target="_blank" class="text-light"><i
                    class="bi bi-link-45deg me-2"></i></a>
              </div>
            </li>

            <li class="nav-item" data-action="my-files">
              <a href="#ThirdPartyExtLEGO" class="nav-link ">
                <i class="bi bi-inboxes me-2"></i>
                <span>Lego SSL/TLS证书</span>
              </a>
            </li>


            <li class="nav-item" data-action="my-files">
              <a href="#ThirdPartyExtOpenlist" class="nav-link ">
                <i class="bi bi-inboxes me-2"></i>
                <span>OpenList云盘</span>
              </a>
            </li>


            <li class="nav-item" data-action="my-files">
              <div class="nav-link d-flex justify-content-between align-items-center">
                <div>
                  <a href="javascript:EditCaddy()" class="text-light text-decoration-none"><i
                      class="bi bi-inboxes me-2"></i>
                    <span>网站服务Caddy2</span>
                  </a>
                </div>
                <a href="#ThirdPartyExtCaddy2" class="text-light"><i class="bi bi-gear me-2"></i></a>

              </div>
            </li>
          </ul>
        </div>
      </li>
    </ul>

  </div>
</div>

<style>
  /* 增加滚动条 防止小屏幕下 无法显示全*/
  .sidebar-inner {
    overflow-y: scroll;
  }

  /* 新增：折叠图标的旋转效果 */
  .collapse-icon {
    transition: transform 0.3s ease-in-out;
  }

  .nav-link[aria-expanded="true"] .collapse-icon {
    transform: rotate(180deg);
  }
</style>

<script>
  // 获取所有导航项
  const navItems = document.querySelectorAll('.sidebar-menu .nav-item');

  // 为每个导航项绑定点击事件
  navItems.forEach(item => {
    item.addEventListener('click', function () {
      // 移除所有导航项的 active 类
      navItems.forEach(navItem => {
        navItem.querySelector('.nav-link').classList.remove('active');
      });

      // 为当前点击的导航项添加 active 类
      this.querySelector('.nav-link').classList.add('active');
    });
  });
</script>
